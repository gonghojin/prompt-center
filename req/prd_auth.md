# 🧩 PRD - 회원 기반 프롬프트 관리 시스템 전환

---

## 📌 프로젝트 개요

- **목적**: 임의 유저 기반 프롬프트 생성에서 실제 회원 기반(로그인/권한/팀) 프롬프트 관리로 전환
- **적용 범위**: 사용자 인증, 권한 관리, 데이터 마이그레이션, 프롬프트/즐겨찾기/검색 시스템 개선

---

## 🛠️ 작업 계획 (Step by Step)

### 1. 사용자 인증 및 권한 시스템 구축 (1주차)
- 회원가입/로그인 API 구현 (JWT 기반)
- OAuth 연동 준비 (선택적)
- 역할 기반 접근 제어(RBAC) 및 팀 기반 권한 설계
- ADMIN, DEVELOPER, DATA_SCIENTIST, DESIGNER 등 역할 정의

#### 세부 계획
- **1일차: 데이터베이스 설계** [완료]
  - User, UserAuthentication, Role, UserRole, Team, TeamMember 테이블 설계 및 정의
- **2~3일차: 인증 시스템 구현** 
  - JWT 기반 인증(토큰 생성/검증, 만료, 리프레시 토큰) [부분 완료- 로그인 이력 제외]
  - 회원가입/로그인/로그아웃 API 구현 (이메일 중복, 비밀번호 암호화, 기본 역할 할당, 로그인 이력)
- **4~5일차: 권한 시스템 구현**
  - RBAC(역할 기반 접근 제어) 미들웨어 및 API 보호
  - 팀 생성/수정/삭제, 팀 멤버 관리, 팀별 권한 설정 API 구현
- **6일차: OAuth 준비**
  - Google, GitHub OAuth 연동 준비 및 콜백 처리, 계정 연동 로직
- **7일차: 테스트 및 문서화**
  - 단위/통합 테스트, Swagger(OpenAPI) 문서화, 보안 검토(비밀번호 정책, 토큰 만료, Rate limiting)
- **고려사항**
  - 비밀번호 정책, 토큰 만료, Rate limiting, 권한 체크 캐싱, DB 인덱싱, 에러 메시지/토큰 갱신/팀 초대 UX 등


#### 🔄 추가 상세 작업 계획 (Spring Security/JWT, API, RBAC)

#### 1. Spring Security/JWT 인증 설정 [완료]
- JWT 토큰 생성, 검증, 파싱 유틸리티 구현
- 토큰 만료 시간, 시크릿 키 등 보안 설정
- SecurityConfig 클래스 생성 및 JWT 필터 등록
- 인증/인가 예외 처리 및 커스텀 핸들러 구현

#### 2. 회원가입/로그인/로그아웃 API [부분 완료-로그인 이력 제외]
- 회원가입 API: 사용자 정보 검증, 비밀번호 암호화, 저장
- 로그인 API: 사용자 인증, JWT/리프레시 토큰 발급, 로그인 이력 저장
- 로그아웃 API: 토큰 블랙리스트 등록, 리프레시 토큰 삭제

#### 3. RBAC 미들웨어
- 역할(Role) 및 권한(Permission) 관리 로직 구현
- RBAC 미들웨어(필터/인터셉터)로 요청별 권한 검증
- 인증된 사용자 정보 및 권한 추출, API 보호

#### 4. 추가 고려사항
- 비밀번호 암호화(BCrypt 등), HTTPS 적용, 토큰 만료/갱신 정책
- 각 API/미들웨어 단위 및 통합 테스트 작성

---

### 2. 데이터베이스 구조 및 마이그레이션 (2주차)
- User, UserAuthentication, Team 등 회원 관련 테이블 생성
- 기존 임의 유저 데이터 → 실제 회원 데이터로 마이그레이션
- 프롬프트/즐겨찾기 등 엔티티의 소유자 필드(외래키) 재설정
- 데이터 무결성 및 참조 무결성 검증

### 3. 프롬프트/즐겨찾기/버전 관리 시스템 개선 (3주차)
- 프롬프트 생성/수정/삭제 시 사용자 권한 체크
- 팀별 프롬프트 공유 및 접근 제어 구현
- 프롬프트 버전 관리(생성/수정/발행/보관) 로직 개선
- 사용자별 즐겨찾기 및 즐겨찾기 메모 기능 구현

### 4. 검색/필터링/통계 시스템 개선 (4주차)
- 권한 기반 프롬프트 검색/필터링
- 팀/공개 범위별 검색 결과 제한
- 사용자/팀별 프롬프트 사용 통계 및 대시보드
- 인기 프롬프트, 활동 추적 등 통계 기능

---

## 🔒 보안 및 성능 고려사항
- JWT 토큰 관리 및 비밀번호 암호화
- API 접근 제어 및 예외 처리 강화
- Redis 등 캐시 전략 적용
- 데이터베이스 인덱싱 및 검색 최적화

---

## 🧪 테스트 전략
- 단위 테스트: 인증/권한/프롬프트 관리 로직
- 통합 테스트: API, 데이터 마이그레이션, 권한 체크
- E2E 테스트: 사용자/팀 시나리오, 검색/필터링

---

## ⏳ 일정 및 우선순위
- 1~2주차: 인증/권한/DB 마이그레이션
- 3주차: 프롬프트/즐겨찾기/버전 관리 개선
- 4주차: 검색/통계/대시보드

---

## 참고 문서
- backend.md, model.md, prd.md
